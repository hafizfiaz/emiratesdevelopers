<?xml version="1.0"?>
<odoo>
    <data>
        <record id="paperformat_customer_penalty" model="report.paperformat">
            <field name="name">Customer Statement With Penalty</field>
            <field name="default" eval="True"/>
            <field name="format">custom</field>
            <field name="page_height">350</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">30</field>
            <field name="margin_bottom">15</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">30</field>
        </record>
        <record id="report_sale_customer_penalty" model="ir.actions.report">
            <field name="paperformat_id" ref="paperformat_customer_penalty"/>
        </record>

        <template id="sale_order_customer_penalty">
            <t t-if="not o" t-set="o" t-value="doc"/>

            <t t-if="not company">
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id"/>
                </t>
                <t t-elif="o and 'company_id' in o">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company"/>
                </t>
            </t>

            <t t-call="sd_sale_order_report.external_layout_header_penalty"/>
            <t t-call="sd_sale_order_report.external_layout_footer_penalty"/>
            <t t-if="company.external_report_layout_id" t-call="{{company.external_report_layout_id.key}}">
                <t t-raw="0"/>
            </t>
            <t t-else="else" t-call="web.external_layout_standard">
                <t t-raw="0"/>
            </t>

        </template>

        <template id="external_layout_header_penalty">
            <div class="header">
                <div style='width:100%;'>
                    <br></br>
                    <div class="row">
                        <div class="col-7">
                            <span style='font-size: 24px; color:#286A9D;'>
                                <b>SAMANA INTERNATIONAL</b>
                            </span>
                        </div>
                        <div class="col-5" style='font-size: 12px;'>
                            <p>4th Floor , Building 7-Bay Square Business Bay,
                                <br/>
                                Dubai - United Arab Emirates
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-7">
                            <span style='font-size: 16px;'>REAL ESTATE DEVELOPMENT</span>
                        </div>
                        <div class="col-5" style='font-size: 12px;'>
                            <p>Email:
                                <span t-field="company.email"/>
                                Website:
                                <span t-field="company.website"/>
                                Phone:
                                <span t-field="company.phone"/>
                            </p>
                        </div>
                    </div>

                    <!--                    <div class="row">-->
                    <!--                        <div class="col-12" style='font-size: 16px;'>-->
                    <!--                            <strong>Date:</strong>-->
                    <!--                            <span t-esc="time.strftime('%d-%b-%Y')"></span>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                </div>
            </div>

        </template>

        <template id="external_layout_footer_penalty">
            <div class="footer">
                <div class="row text-left" style="border-top: 1px solid black;">
                    <div class="col-12">
                        <span class="page"/>
                        <span>|</span>
                        <span>SAMANA INTERNATIONAL</span>
                    </div>
                </div>
            </div>
        </template>

        <template id="report_sale_penalty_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="sd_sale_order_report.sale_order_customer_penalty">
                        <t t-set="o" t-value="o.with_context({'lang': lang})"/>
                        <div class="page" style='font-size: 12px;'>
                            <style>

                                .table-bordered {
                                border: 1px solid black;
                                margin: 6px;
                                }

                                .table-bordered th,
                                .table-bordered tr,
                                .table-bordered td {
                                border: 1px solid black;

                                }

                                .table-bordered thead th,
                                .table-bordered thead tr,
                                .table-bordered thead td {
                                border-bottom-width: 1px;
                                }

                                .table {
                                width: 100%;
                                margin-bottom: 1rem;
                                background-color: transparent;
                                }

                                .table th,
                                .table td {
                                padding: 0.75rem;
                                vertical-align: top;
                                border-top: 1px solid balck;
                                }

                                .table thead th {
                                vertical-align: bottom;
                                border-bottom: 1px solid black;
                                }

                                .table tbody + tbody {
                                border-top: 1px solid black;
                                }

                            </style>
                            <div class='page' style="line-height:13px;font-size:13px;">
                                <div class="row text-center">
                                    <div class="col-8">
                                        <h4 class="text-right">
                                            <strong>CUSTOMER STATEMENT</strong>
                                        </h4>
                                    </div>
                                    <div class="col-4 text-right">
                                        <img t-if="o.name"
                                             t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' %('Code128',o.name,220,30)"/>
                                        <!--</t>-->
                                    </div>
                                </div>
                                <br/>

                                <table class="table" style="padding:none;margin:none; line-height: 2pt">

                                    <tr style="padding:none;margin:none; line-height: 9pt;">
                                        <td style="border:none" width="20%">
                                            <strong>Customer Name:</strong>
                                        </td>
                                        <td style="border:none" width="30%">
                                            <span t-esc="o.partner_id.name"/>
                                        </td>
                                        <td style="border:none" width="20%">
                                            <strong>Project:</strong>
                                        </td>
                                        <td style="border:none" width="30%">
                                            <span t-esc="o.asset_project_id.name"/>
                                        </td>
                                    </tr>
                                    <tr style="padding:none;margin:none">
                                        <td style="border:none">
                                            <strong>Mobile:</strong>
                                        </td>
                                        <td style="border:none">
                                            <span t-esc="o.partner_id.mobile"/>
                                        </td>
                                        <td style="border:none">
                                            <strong>Property:</strong>
                                        </td>
                                        <td style="border:none">
                                            <span t-esc="o.property_id.name"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none">
                                            <strong>Email:</strong>
                                        </td>
                                        <td style="border:none">
                                            <span t-esc="o.partner_id.email"/>
                                        </td>
                                        <!--                                        <td style="border:none">-->
                                        <!--                                            <strong>Booking No:</strong>-->
                                        <!--                                        </td>-->
                                        <!--                                        <td style="border:none">-->
                                        <!--                                            <span t-esc="o.name"/>-->
                                        <!--                                        </td>-->
                                    </tr>
                                    <tr height="20px">
                                        <td style="border:none">
                                            <strong>Statement Date:</strong>
                                        </td>
                                        <td style="border:none">
                                            <span t-esc="time.strftime('%d-%b-%Y')"/>
                                        </td>
                                        <td style="border:none">
                                            <strong>SPA:</strong>
                                        </td>
                                        <td style="border:none">
                                            <span t-esc="o.name"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none">
                                            <strong></strong>
                                        </td>
                                        <td style="border:none"></td>
                                        <td style="border:none">
                                            <strong>Sale Date:</strong>
                                        </td>
                                        <td style="border:none">
                                            <span t-field="o.booking_date" t-options='{"format": "dd/MM/yyyy"}'/>
                                        </td>
                                    </tr>

                                </table>


                                <table class="table" style="border:none;margin:none; line-height: 2pt;">
                                    <thead>
                                        <tr>
                                            <th class="text-center" colspan="2">
                                                <strong>DETAILS</strong>
                                            </th>
                                            <th class="text-center" colspan="2">
                                                <strong>COLLECTIONS DETAILS</strong>
                                            </th>

                                        </tr>
                                    </thead>

                                    <tr style="border:none; line-height: 10pt;">
                                        <td style="border:none" width="25%">Property Price:</td>
                                        <td style="border:none" width="25%">
                                            <span t-esc="'{:,.2f}'.format(o.price)"/>
                                        </td>
                                        <td style="border:none" width="30%">
                                            <strong>Amount Received (Realized Collections)</strong>
                                        </td>
                                        <td style="border:none" width="20%">
                                            <strong>
                                                <span t-if="o.matured_pdcs" t-esc="'{:,.2f}'.format(o.matured_pdcs)"/>
                                            </strong>
                                            <strong>
                                                <span t-if="not o.matured_pdcs">-</span>
                                            </strong>
                                        </td>
                                    </tr>
                                    <tr style="border:none">
                                        <td style="border:none" width="25%">VAT</td>
                                        <td style="border:none" width="25%">
                                            <span t-esc="'{:,.2f}'.format(o.vat_amount)"/>
                                        </td>
                                        <td style="border:none"></td>
                                        <td style="border:none">
                                        </td>
                                    </tr>
                                    <tr style="border:none">
                                        <td style="border:none" width="25%">
                                            <strong>Property Price Incl. VAT:</strong>
                                        </td>
                                        <td style="border:none" width="25%">
                                            <strong>
                                                <span t-esc="'{:,.2f}'.format(o.property_inc_vat_amount)"/>
                                            </strong>
                                        </td>
                                        <td style="border:none; color: #8b0000;">
                                            <strong>Balance Due Collection</strong>
                                        </td>
                                        <td style="border:none; color: #8b0000;">
                                            <t t-set="total_due_collection"
                                               t-value="o.amount_till_date + o.oqood_fee + o.admin_fee + o.other_charges - o.matured_pdcs"/>
                                            <strong>
                                                <span t-if="total_due_collection &gt; 0"
                                                      t-esc="'{:,.2f}'.format(total_due_collection)"/>
                                            </strong>
                                            <strong>
                                                <span t-if="total_due_collection &lt;= 0"/>0
                                            </strong>
                                            <strong>
                                                <span t-if="not total_due_collection">-</span>
                                            </strong>
                                        </td>
                                    </tr>
                                    <tr style="border:none">
                                        <td style="border:none">Oqood Fee Charged:</td>
                                        <td style="border:none">
                                            <span t-if="o.oqood_fee" t-esc="'{:,.2f}'.format(o.oqood_fee)"/>
                                            <span t-if="not o.oqood_fee">-</span>
                                        </td>
                                        <td style="border:none"></td>
                                        <td style="border:none">

                                        </td>
                                    </tr>
                                    <tr style="border:none">
                                        <td style="border:none">Admin Fee Charged:</td>
                                        <td style="border:none">
                                            <span t-if="o.admin_fee" t-esc="'{:,.2f}'.format(o.admin_fee)"/>
                                            <span t-if="not o.admin_fee">-</span>
                                        </td>
                                        <td class="test-left" colspan="2" style="border:none">
                                            <strong>Un-realized Collections</strong>
                                        </td>

                                    </tr>
                                    <tr style="border:none">
                                        <td style="border:none">Other Charges:</td>
                                        <td style="border:none">
                                            <span t-if="o.other_charges" t-esc="'{:,.2f}'.format(o.other_charges)"/>
                                            <span t-if="not o.other_charges">-</span>
                                        </td>
                                        <td style="border:none"></td>
                                        <td style="border:none">

                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none"></td>
                                        <td style="border:none">

                                        </td>
                                        <td style="border:none">Non-Matured Collections</td>
                                        <td style="border:none">
                                            <span t-if="o.un_matured_pdcs" t-esc="'{:,.2f}'.format(o.un_matured_pdcs)"/>
                                            <span t-if="not o.un_matured_pdcs">-</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none">
                                            <strong>Total Collectable Amount</strong>
                                        </td>
                                        <td style="border:none">
                                            <t t-set="total_collectable"
                                               t-value="o.property_inc_vat_amount + o.oqood_fee + o.admin_fee + o.other_charges"/>
                                            <strong>
                                                <span t-if="total_collectable"
                                                      t-esc="'{:,.2f}'.format(total_collectable)"/>
                                            </strong>
                                            <strong>
                                                <span t-if="not total_collectable">-</span>
                                            </strong>
                                        </td>
                                        <td style="border:none">Cheques Held</td>
                                        <td style="border:none">
                                            <span t-if="o.hold_pdcs" t-esc="'{:,.2f}'.format(o.hold_pdcs)"/>
                                            <span t-if="not o.hold_pdcs">-</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none"></td>
                                        <td style="border:none">

                                        </td>
                                        <td style="border:none">Un Cleared Cheques</td>
                                        <td style="border:none">
                                            <span t-if="o.deposited_pdcs" t-esc="'{:,.2f}'.format(o.deposited_pdcs)"/>
                                            <span t-if="not o.deposited_pdcs">-</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none">Total Installments Due</td>
                                        <td style="border:none">
                                            <span t-if="o.amount_till_date"
                                                  t-esc="'{:,.2f}'.format(o.amount_till_date)"/>
                                            <span t-if="not o.amount_till_date">-</span>
                                        </td>
                                        <td style="border:none;">Bounced Cheques</td>
                                        <td style="border:none;">
                                            <span t-if="o.bounced_pdcs" t-esc="'{:,.2f}'.format(o.bounced_pdcs)"/>
                                            <span t-if="not o.bounced_pdcs">-</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none">Admin fee</td>
                                        <td style="border:none">
                                            <span t-if="o.admin_fee" t-esc="'{:,.2f}'.format(o.admin_fee)"/>
                                            <span t-if="not o.admin_fee">-</span>
                                        </td>
                                        <td style="border:none;">Total Unsecured Collections</td>
                                        <td style="border:none;">
                                            <t t-set="total_unsecured_collection"
                                               t-value="o.un_matured_pdcs + o.hold_pdcs + o.deposited_pdcs + o.bounced_pdcs"/>
                                            <span t-if="total_unsecured_collection"
                                                  t-esc="'{:,.2f}'.format(total_unsecured_collection)"/>
                                            <span t-if="not total_unsecured_collection">-</span>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td style="border:none">Oqood Fee</td>
                                        <td style="border:none">
                                            <span t-if="o.oqood_fee" t-esc="'{:,.2f}'.format(o.oqood_fee)"/>
                                            <span t-if="not o.oqood_fee">-</span>
                                        </td>
                                        <td style="border:none;"></td>
                                        <td style="border:none;">
                                        </td>
                                    </tr>

                                    <tr>
                                        <td style="border:none">Other Charges</td>
                                        <td style="border:none">
                                            <span t-if="o.other_charges" t-esc="'{:,.2f}'.format(o.other_charges)"/>
                                            <span t-if="not o.other_charges">-</span>
                                        </td>
                                        <td style="border:none;">
                                            <strong>Total Collections</strong>
                                        </td>
                                        <td style="border:none;">
                                            <t t-set="total_collection"
                                               t-value="o.un_matured_pdcs + o.hold_pdcs + o.deposited_pdcs + o.bounced_pdcs + o.matured_pdcs"/>
                                            <strong>
                                                <span t-if="total_collection"
                                                      t-esc="'{:,.2f}'.format(total_collection)"/>
                                            </strong>
                                            <strong>
                                                <span t-if="not total_collection">-</span>
                                            </strong>
                                        </td>
                                    </tr>


                                    <tr style="border:none">
                                        <td style="border:none" width="25%"></td>
                                        <td style="border:none" width="25%"></td>
                                        <td style="border:none" width="25%"></td>
                                        <td style="border:none" width="25%">
                                        </td>
                                    </tr>
                                    <tr style="border:none">
                                        <td style="border:none" width="25%">
                                            <strong>Total Due Amount</strong>
                                        </td>
                                        <td style="border:none" width="25%">
                                            <t t-set="total_due"
                                               t-value="o.amount_till_date + o.oqood_fee + o.admin_fee + o.other_charges"/>
                                            <strong>
                                                <span t-if="total_due" t-esc="'{:,.2f}'.format(total_due)"/>
                                            </strong>
                                            <strong>
                                                <span t-if="not total_due">-</span>
                                            </strong>
                                        </td>
                                        <td style="border:none; color: #000066;">
                                            <strong>Pending Collections</strong>
                                        </td>
                                        <td style="border:none; color: #000066;">
                                            <t t-set="pending_collection"
                                               t-value="total_collectable - total_collection"/>
                                            <strong>
                                                <span t-if="pending_collection"
                                                      t-esc="'{:,.2f}'.format(pending_collection)"/>
                                            </strong>
                                            <strong>
                                                <span t-if="not pending_collection">-</span>
                                            </strong>
                                        </td>
                                    </tr>
                                </table>
                                <br/>
                                <br/>
                                <br/>
                                <strong style="margin-top:40px; font-size:18px;">Due Amount Details
                                </strong>
                                <div style="margin-top:20px;"></div>
                                <table class="table table-bordered text-center" style="font-size:15px;">
                                    <thead>
                                        <tr>
                                            <th>Description</th>
                                            <th>Due Amount (AED)</th>
                                            <th>Paid Amount (AED)</th>
                                            <th>Balance Due Collections (AED)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-set="due_total" t-value="0.00"/>
                                        <t t-set="pending_total" t-value="0.00"/>
                                        <t t-set="balance_total" t-value="0.00"/>
                                        <t t-set="penalty_total" t-value="0.00"/>
                                        <tr>
                                            <td>Installments</td>
                                            <td>
                                                <span t-if="o.amount_till_date"
                                                      t-esc="'{:,.2f}'.format(o.amount_till_date)"/>
                                                <span t-if="not o.amount_till_date">-</span>
                                                <t t-set="due_total" t-value="due_total+o.amount_till_date"/>
                                            </td>
                                            <td>
                                                <span t-if="o.paid_installments"
                                                      t-esc="'{:,.2f}'.format(o.paid_installments)"/>
                                                <span t-if="not o.paid_installments">-</span>
                                                <t t-set="pending_total" t-value="pending_total+o.paid_installments"/>
                                            </td>
                                            <td>
                                                <span t-if="o.installment_balance_pending"
                                                      t-esc="'{:,.2f}'.format(o.installment_balance_pending)"/>
                                                <span t-if="not o.installment_balance_pending">-</span>
                                                <t t-set="balance_total"
                                                   t-value="balance_total+o.installment_balance_pending"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Oqood Fee</td>
                                            <td>
                                                <span t-if="o.oqood_fee" t-esc="'{:,.2f}'.format(o.oqood_fee)"/>
                                                <span t-if="not o.oqood_fee">-</span>
                                                <t t-set="due_total" t-value="due_total+o.oqood_fee"/>
                                            </td>
                                            <td>
                                                <span t-if="o.oqood_received"
                                                      t-esc="'{:,.2f}'.format(o.oqood_received)"/>
                                                <span t-if="not o.oqood_received">-</span>
                                                <t t-set="pending_total" t-value="pending_total+o.oqood_received"/>
                                            </td>
                                            <td>
                                                <span t-if="o.balance_due_oqood"
                                                      t-esc="'{:,.2f}'.format(o.balance_due_oqood)"/>
                                                <span t-if="not o.balance_due_oqood">-</span>
                                                <t t-set="balance_total" t-value="balance_total+o.balance_due_oqood"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Admin Fee</td>
                                            <td>
                                                <span t-if="o.admin_fee" t-esc="'{:,.2f}'.format(o.admin_fee)"/>
                                                <span t-if="not o.admin_fee">-</span>
                                                <t t-set="due_total" t-value="due_total+o.admin_fee"/>
                                            </td>
                                            <td>
                                                <span t-if="o.admin_received"
                                                      t-esc="'{:,.2f}'.format(o.admin_received)"/>
                                                <span t-if="not o.admin_received">-</span>
                                                <t t-set="pending_total" t-value="pending_total+o.admin_received"/>
                                            </td>
                                            <td>
                                                <span t-if="o.balance_due_admin"
                                                      t-esc="'{:,.2f}'.format(o.balance_due_admin)"/>
                                                <span t-if="not o.balance_due_admin">-</span>
                                                <t t-set="balance_total" t-value="balance_total+o.balance_due_admin"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Other Charges</td>
                                            <td>
                                                <span t-if="o.other_charges" t-esc="'{:,.2f}'.format(o.other_charges)"/>
                                                <span t-if="not o.other_charges">-</span>
                                                <t t-set="due_total" t-value="due_total+o.other_charges"/>
                                            </td>
                                            <td>
                                                <span t-if="o.other_received"
                                                      t-esc="'{:,.2f}'.format(o.other_received)"/>
                                                <span t-if="not o.other_received">-</span>
                                                <t t-set="pending_total" t-value="pending_total+o.other_received"/>
                                            </td>
                                            <td>
                                                <span t-if="o.balance_due_other"
                                                      t-esc="'{:,.2f}'.format(o.balance_due_other)"/>
                                                <span t-if="not o.balance_due_other">-</span>
                                                <t t-set="balance_total" t-value="balance_total+o.balance_due_other"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Penalty</td>
                                            <t t-foreach="docs.sale_payment_schedule_ids" t-as="pen">
                                                <t t-set="penalty_total" t-value="penalty_total+pen.penalty"/>
                                            </t>
                                            <td>
                                                <span t-if="penalty_total" t-esc="'{:,.2f}'.format(penalty_total)"/>
                                                <span t-if="not penalty_total">-</span>
                                                <t t-set="due_total" t-value="due_total+ penalty_total"/>
                                            </td>
                                            <td>
                                                <span>-</span>
                                            </td>
                                            <td>
                                                <span t-if="penalty_total" t-esc="'{:,.2f}'.format(penalty_total)"/>
                                                <span t-if="not penalty_total">-</span>
                                                <t t-set="balance_total" t-value="balance_total+penalty_total"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Total</th>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(due_total)"/>
                                                </strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(pending_total)"/>
                                                </strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(balance_total)"/>
                                                </strong>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <br/>
                                <br/>
                                <strong style="margin-top:40px; font-size:18px;">PAYMENT SCHEDULE</strong>
                                <div style="margin-top:20px;"></div>
                                <table class="table table-bordered text-center" style="font-size:15px;">
                                    <thead>
                                        <tr>
                                            <th>Sr. #</th>
                                            <th width="85px">Due Date</th>
                                            <th>Installment Amount</th>
                                            <th>VAT Amount</th>
                                            <th>Installment Amount Incl. VAT</th>
                                            <th>Penalty</th>
                                            <th>Installment Status</th>
                                            <th>Received Amount</th>
                                            <th>Overdue Amount</th>
                                            <th>Delay Days</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-set="installment_total" t-value="0.00"/>
                                        <t t-set="vat_total" t-value="0.00"/>
                                        <t t-set="installment_total_inc_vat" t-value="0.00"/>
                                        <t t-set="received_total" t-value="0.00"/>
                                        <t t-set="overdue_total" t-value="0.00"/>
                                        <t t-set="penalty_total" t-value="0.00"/>
                                        <t t-foreach="docs.sale_payment_schedule_ids.sorted(key=lambda x: x.start_date, reverse=False)"
                                            t-as="schedule">
                                            <t t-if="schedule.state != 'cancel'">
                                                <tr>
                                                    <td>
                                                        <span t-esc="schedule.sequence"/>
                                                    </td>
                                                    <td>
                                                        <span t-field="schedule.start_date"
                                                              t-options='{"format": "dd/MM/yyyy"}'/>
                                                    </td>
                                                    <td>
                                                        <span t-if="schedule.amount_without_vat"
                                                              t-esc="'{:,.2f}'.format(schedule.amount_without_vat)"/>
                                                        <t t-if="schedule.amount_without_vat">
                                                            <t t-set="installment_total"
                                                               t-value="installment_total+schedule.amount_without_vat"/>
                                                        </t>
                                                        <span t-if="not schedule.amount_without_vat">-</span>
                                                    </td>
                                                    <td>
                                                        <span t-if="schedule.vat_amount"
                                                              t-esc="'{:,.2f}'.format(schedule.vat_amount)"/>
                                                        <t t-if="schedule.vat_amount">
                                                            <t t-set="vat_total" t-value="vat_total+schedule.vat_amount"/>
                                                        </t>
                                                        <span t-if="not schedule.vat_amount">-</span>
                                                    </td>
                                                    <td>
                                                        <span t-if="schedule.amount" t-esc="'{:,.2f}'.format(schedule.amount)"/>
                                                        <t t-if="schedule.amount">
                                                            <t t-set="installment_total_inc_vat"
                                                               t-value="installment_total_inc_vat+schedule.amount"/>
                                                        </t>
                                                        <span t-if="not schedule.amount">-</span>
                                                    </td>
                                                    <td class="text-center">
                                                        <t t-if="schedule.penalty">
                                                            <span t-esc="'{:,.0f}'.format(schedule.penalty)"/>
                                                            <t t-set="penalty_total"
                                                               t-value="penalty_total + schedule.penalty"/>
                                                        </t>
                                                        <span t-if="not schedule.penalty">-</span>
                                                    </td>
                                                    <td>
                                                        <t t-if="schedule.installment_status == 'paid'">
                                                            Paid
                                                        </t>
                                                        <t t-if="schedule.installment_status == 'unpaid'">
                                                            Unpaid
                                                        </t>
                                                        <t t-if="schedule.installment_status == 'partially_paid'">
                                                            Partially Paid
                                                        </t>
                                                        <t t-if="schedule.installment_status == 'default'">
                                                            Default
                                                        </t>
                                                        <t t-if="schedule.installment_status == 'cancel'">
                                                            Cancel
                                                        </t>
                                                    </td>
                                                    <td>
                                                        <span t-if="schedule.receipt_total"
                                                              t-esc="'{:,.2f}'.format(schedule.receipt_total)"/>
                                                        <t t-if="schedule.receipt_total">
                                                            <t t-set="received_total"
                                                               t-value="received_total+schedule.receipt_total"/>
                                                        </t>
                                                        <span t-if="not schedule.receipt_total">-</span>
                                                    </td>

                                                    <td>
                                                        <t t-if="schedule.pen_amt">
                                                            <t t-set="p_amt" t-value="schedule.pen_amt + schedule.penalty"/>
                                                            <span t-esc="'{:,.2f}'.format(p_amt)"/>
                                                            <t t-set="overdue_total" t-value="overdue_total + p_amt"/>
                                                        </t>
                                                        <span t-if="not schedule.pen_amt">-</span>
                                                    </td>
                                                    <td>
                                                        <span t-if="schedule.delay_days" t-field="schedule.delay_days"/>
                                                        <span t-if="not schedule.delay_days">-</span>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(installment_total)"/>
                                                </strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(vat_total)"/>
                                                </strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(installment_total_inc_vat)"/>
                                                </strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(penalty_total)"/>
                                                </strong>
                                            </td>
                                            <td></td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(received_total)"/>
                                                </strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.2f}'.format(overdue_total)"/>
                                                </strong>
                                            </td>
                                            <td></td>
                                        </tr>
                                    </tbody>

                                </table>


                                <t t-set="sub_total_realized" t-value="0.0"/>
                                <t t-set="sub_total_unrealized" t-value="0.0"/>
                                <strong t-if="o.receipt_ids" style="margin-top:40px; font-size:18px;">RECEIPTS
                                    (Realized)
                                </strong>
                                <div style="margin-top:20px;"></div>
                                <table t-if="o.receipt_ids" class="table table-bordered text-center"
                                       style="font-size:15px;">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Receipt No.</th>
                                            <th>Cheque No.</th>
                                            <th>Maturity Date</th>
                                            <th>Amount</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="o.receipt_ids" t-as="receipt">
                                            <t t-if="receipt.state == 'posted'">
                                                <td>
                                                    <span t-field="receipt.date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-if="not receipt.old_name" t-field="receipt.name"/>
                                                    <span t-if="receipt.old_name" t-field="receipt.old_name"/>
                                                </td>
                                                <td>
                                                    <span t-esc="receipt.check_number"/>
                                                </td>
                                                <td>
                                                    <span t-field="receipt.maturity_date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-esc="'{:,.2f}'.format(receipt.amount)"/>
                                                    <t t-set="sub_total_realized"
                                                       t-value="sub_total_realized+receipt.amount"/>
                                                </td>
                                                <td>
                                                    <t t-if="receipt.state == 'draft'">
                                                        Draft
                                                    </t>
                                                    <t t-if="receipt.state == 'under_approval'">
                                                        Under Approval
                                                    </t>
                                                    <t t-if="receipt.state == 'approved'">
                                                        Approved
                                                    </t>
                                                    <t t-if="receipt.state == 'rejected'">
                                                        Rejected
                                                    </t>
                                                    <t t-if="receipt.state == 'proforma'">
                                                        Pro-forma
                                                    </t>
                                                    <t t-if="receipt.state == 'pending'">
                                                        Pending for Collection
                                                    </t>
                                                    <t t-if="receipt.state == 'collected'">
                                                        Collected
                                                    </t>
                                                    <t t-if="receipt.state == 'outsourced'">
                                                        Withdraw
                                                    </t>
                                                    <t t-if="receipt.state == 'replaced'">
                                                        Replaced
                                                    </t>
                                                    <t t-if="receipt.state == 'hold'">
                                                        Hold
                                                    </t>
                                                    <t t-if="receipt.state == 'paid_unposted'">
                                                        Deposited/In-Cashed
                                                    </t>
                                                    <t t-if="receipt.state == 'posted'">
                                                        Posted
                                                    </t>
                                                    <t t-if="receipt.state == 'sent'">
                                                        Sent
                                                    </t>
                                                    <t t-if="receipt.state == 'reconciled'">
                                                        Reconciled
                                                    </t>
                                                    <t t-if="receipt.state == 'cancelled'">
                                                        Cancelled
                                                    </t>
                                                    <t t-if="receipt.state == 'refused'">
                                                        Bounced
                                                    </t>
                                                </td>
                                            </t>
                                        </tr>
                                    </tbody>


                                </table>

                                <div t-if="o.receipt_ids" class="row"
                                     style="margin-left:6px; page-break-inside: avoid; line-height: 2;border-bottom: 1px solid black; width:100%">
                                    <div class="col-9" style="font-size:14px;font-weight: bold;">Sub Total</div>
                                    <div class="col-3" style="font-size:14px;font-weight: bold;">
                                        <span t-esc="'{:,.2f}'.format(sub_total_realized)"/>
                                    </div>
                                </div>
                                <br/>
                                <br/>
                                <br/>

                                <strong t-if="o.receipt_ids" style="margin-top:40px; font-size:18px;">RECEIPTS
                                    Unrealized/PDCs
                                </strong>
                                <div style="margin-top:20px;"></div>
                                <table t-if="o.receipt_ids" class="table table-bordered text-center"
                                       style="font-size:15px;">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Receipt No.</th>
                                            <th>Cheque No.</th>
                                            <th>Maturity Date</th>
                                            <th>Amount</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                        <tr t-foreach="o.receipt_ids" t-as="receipt">
                                            <t t-if="receipt.state not in ['draft','cancelled','posted','outsourced','rejected','settle']">
                                                <td>
                                                    <span t-field="receipt.date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-if="not receipt.old_name" t-field="receipt.name"/>
                                                    <span t-if="receipt.old_name" t-field="receipt.old_name"/>
                                                </td>
                                                <td>
                                                    <span t-esc="receipt.check_number"/>
                                                </td>
                                                <td>
                                                    <span t-field="receipt.maturity_date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-esc="'{:,.2f}'.format(receipt.amount)"/>
                                                    <t t-set="sub_total_unrealized"
                                                       t-value="sub_total_unrealized+receipt.amount"/>
                                                </td>
                                                <td>
                                                    <t t-if="receipt.state == 'draft'">
                                                        Draft
                                                    </t>
                                                    <t t-if="receipt.state == 'under_approval'">
                                                        Under Approval
                                                    </t>
                                                    <t t-if="receipt.state == 'approved'">
                                                        Approved
                                                    </t>
                                                    <t t-if="receipt.state == 'rejected'">
                                                        Rejected
                                                    </t>
                                                    <t t-if="receipt.state == 'proforma'">
                                                        Pro-forma
                                                    </t>
                                                    <t t-if="receipt.state == 'pending'">
                                                        Pending for Collection
                                                    </t>
                                                    <t t-if="receipt.state == 'collected'">
                                                        Collected
                                                    </t>
                                                    <t t-if="receipt.state == 'outsourced'">
                                                        Withdraw
                                                    </t>
                                                    <t t-if="receipt.state == 'replaced'">
                                                        Replaced
                                                    </t>
                                                    <t t-if="receipt.state == 'hold'">
                                                        Hold
                                                    </t>
                                                    <t t-if="receipt.state == 'paid_unposted'">
                                                        Deposited/In-Cashed
                                                    </t>
                                                    <t t-if="receipt.state == 'posted'">
                                                        Posted
                                                    </t>
                                                    <t t-if="receipt.state == 'sent'">
                                                        Sent
                                                    </t>
                                                    <t t-if="receipt.state == 'reconciled'">
                                                        Reconciled
                                                    </t>
                                                    <t t-if="receipt.state == 'cancelled'">
                                                        Cancelled
                                                    </t>
                                                    <t t-if="receipt.state == 'refused'">
                                                        Bounced
                                                    </t>
                                                </td>
                                            </t>
                                        </tr>
                                    </tbody>


                                </table>


                                <div t-if="o.receipt_ids" class="row"
                                     style="margin-left:6px; page-break-inside: avoid; line-height: 2;border-bottom: 1px solid black; width:100%">
                                    <div class="col-9" style="font-size:14px;font-weight: bold;">Sub Total</div>
                                    <div class="col-3" style="font-size:14px;font-weight: bold;">
                                        <span t-esc="'{:,.2f}'.format(sub_total_unrealized)"/>
                                    </div>
                                </div>
                                <div t-if="o.receipt_ids" class="row"
                                     style="margin-left:6px; page-break-inside: avoid; line-height: 2;border-bottom: 2px solid black; width:100%">
                                    <div class="col-9" style="font-size:14px;font-weight: bold;">Grand Total -
                                        Receipts
                                    </div>
                                    <div class="col-3" style="font-size:14px;font-weight: bold;">
                                        <span t-esc="'{:,.2f}'.format(sub_total_realized + sub_total_unrealized)"/>
                                    </div>
                                </div>
                                <br/>

                                <t t-set="not_print" t-value="2"/>

                                <div t-if="not_print == 2 and docs.payments_ids" class="row"
                                     style="page-break-inside: avoid;">
                                    <div class="col-6" style="font-size:18px; margin-top:30px;">
                                        <strong>FGR PAYMENT</strong>
                                    </div>
                                    <div class="col-6" style="margin-left:200px;font-size:18px;margin-top:30px;">
                                        <strong>
                                            <u>AED</u>
                                        </strong>

                                    </div>
                                </div>

                                <div t-if="not_print == 2 and docs.payments_ids" class="row"
                                     style="margin-top:15px; page-break-inside: avoid">
                                    <div class="col-6">
                                        Total FGR Paid:

                                    </div>
                                    <div class="col-6" style="margin-left:200px;">
                                        <t t-set="total_fgr" t-value="0"/>
                                        <t t-foreach="docs.payments_ids" t-as="paid">
                                            <t t-if="paid.state in ['paid_unposted','posted'] and paid.partner_id.id == docs.partner_id.id and paid.property_id.id == docs.property_id.id">
                                                <t t-set="total_fgr" t-value="total_fgr+paid.amount"/>
                                            </t>
                                        </t>
                                        <span t-if="total_fgr" t-esc="'{:,.2f}'.format(total_fgr)"/>
                                        <span t-if="not total_fgr">-</span>

                                    </div>
                                </div>

                                <div t-if="not_print == 2 and docs.payments_ids" class="row"
                                     style="margin-top:15px; page-break-inside: avoid">
                                    <div class="col-6">
                                        Matured PDCs:

                                    </div>
                                    <div class="col-6" style="margin-left:200px;">
                                        <t t-set="total_matured" t-value="0"/>
                                        <t t-foreach="docs.payments_ids" t-as="paid">
                                            <t t-if="paid.state in ['pending','collected'] and paid.partner_id.id == docs.partner_id.id and paid.property_id.id == docs.property_id.id">
                                                <t t-set="total_matured" t-value="total_matured+paid.amount"/>
                                            </t>

                                        </t>
                                        <span t-if="total_matured" t-esc="'{:,.2f}'.format(total_matured)"/>
                                        <span t-if="not total_matured">-</span>

                                    </div>
                                </div>

                                <div t-if="not_print == 2 and docs.payments_ids" class="row"
                                     style="margin-top:15px; page-break-inside: avoid">
                                    <div class="col-6">
                                        Unmatured PDCs:

                                    </div>
                                    <div class="col-6" style="margin-left:200px;">
                                        <t t-set="total_matured" t-value="0"/>
                                        <t t-foreach="docs.payments_ids" t-as="paid">
                                            <t t-if="paid.state in ['pending','collected'] and paid.partner_id.id == docs.partner_id.id and paid.property_id.id == docs.property_id.id">
                                                <t t-set="total_matured" t-value="total_matured+paid.amount"/>
                                            </t>

                                        </t>
                                        <span t-if="total_matured" t-esc="'{:,.2f}'.format(total_matured)"/>
                                        <span t-if="not total_matured">-</span>
                                    </div>
                                </div>

                                <div t-if="not_print == 2 and docs.payments_ids" class="row"
                                     style="margin-top:15px; page-break-inside: avoid">
                                    <div class="col-6">
                                        Bounced PDCs:

                                    </div>
                                    <div class="col-6" style="margin-left:200px;">
                                        <t t-set="total_matured" t-value="0"/>
                                        <t t-foreach="docs.payments_ids" t-as="paid">
                                            <t t-if="paid.state in ['refused'] and paid.partner_id.id == docs.partner_id.id and paid.property_id.id == docs.property_id.id">
                                                <t t-set="total_matured" t-value="total_matured+paid.amount"/>
                                            </t>

                                        </t>
                                        <span t-if="total_matured" t-esc="'{:,.2f}'.format(total_matured)"/>
                                        <span t-if="not total_matured">-</span>

                                    </div>
                                </div>

                                <table t-if="not_print == 2 and docs.payments_ids" class="table table-bordered"
                                       style="margin-top:40px;">
                                    <thead>
                                        <tr>
                                            <th>Sr. #</th>
                                            <th>Date</th>
                                            <th>Payment No.</th>
                                            <th>Check No</th>
                                            <th>Maturity Date</th>
                                            <th>Collection Date</th>
                                            <th>Remarks</th>
                                            <th>Status</th>
                                            <th>Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-set="sr" t-value="1"/>
                                        <t t-set="total" t-value="0"/>
                                        <tr t-foreach="docs.payments_ids" t-as="payment">
                                            <t t-if="payment.partner_id.id == docs.partner_id.id and payment.property_id.id == docs.property_id.id">
                                                <td>
                                                    <span t-esc="sr"/>
                                                </td>
                                                <td>
                                                    <span t-field="payment.date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-esc="payment.name"/>
                                                </td>
                                                <td>
                                                    <span t-esc="payment.check_number"/>
                                                </td>
                                                <td>
                                                    <span t-field="payment.maturity_date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-field="payment.collection_date"
                                                          t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                                <td>
                                                    <span t-esc="payment.remarks"/>
                                                </td>

                                                <td>
                                                    <t t-if="payment.state == 'draft'">
                                                        Draft
                                                    </t>
                                                    <t t-if="payment.state == 'under_approval'">
                                                        Under Approval
                                                    </t>
                                                    <t t-if="payment.state == 'approved'">
                                                        Approved
                                                    </t>
                                                    <t t-if="payment.state == 'rejected'">
                                                        Rejected
                                                    </t>
                                                    <t t-if="payment.state == 'proforma'">
                                                        Pro-forma
                                                    </t>
                                                    <t t-if="payment.state == 'pending'">
                                                        Pending for Collection
                                                    </t>
                                                    <t t-if="payment.state == 'collected'">
                                                        Collected
                                                    </t>
                                                    <t t-if="payment.state == 'outsourced'">
                                                        Withdraw
                                                    </t>
                                                    <t t-if="payment.state == 'replaced'">
                                                        Replaced
                                                    </t>
                                                    <t t-if="payment.state == 'hold'">
                                                        Hold
                                                    </t>
                                                    <t t-if="payment.state == 'paid_unposted'">
                                                        Deposited/In-Cashed
                                                    </t>
                                                    <t t-if="payment.state == 'posted'">
                                                        Posted
                                                    </t>
                                                    <t t-if="payment.state == 'sent'">
                                                        Sent
                                                    </t>
                                                    <t t-if="payment.state == 'reconciled'">
                                                        Reconciled
                                                    </t>
                                                    <t t-if="payment.state == 'cancelled'">
                                                        Cancelled
                                                    </t>
                                                    <t t-if="payment.state == 'refused'">
                                                        Bounced
                                                    </t>
                                                </td>
                                                <td>
                                                    <span t-if="payment.amount"
                                                          t-esc="'{:,.2f}'.format(payment.amount)"/>
                                                    <span t-if="not payment.amount">-</span>
                                                </td>
                                                <t t-set="sr" t-value="sr+1"/>
                                                <t t-set="total" t-value="total+payment.amount"/>
                                            </t>

                                        </tr>
                                        <tr>
                                            <td colspan="8">
                                                <strong>Total</strong>
                                            </td>
                                            <td>
                                                <strong>
                                                    <span t-if="total" t-esc="'{:,.2f}'.format(total)"/>
                                                    <span t-if="not total">-</span>
                                                </strong>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>


                                <strong t-if="o.add_charges_ids or o.less_charges_ids and not_print == 1"
                                        style="margin-top:40px; font-size:18px;">Other Charges Detail
                                </strong>
                                <table t-if="o.add_charges_ids or o.less_charges_ids and not_print == 1"
                                       class="table table-bordered" style="margin-top:40px;">
                                    <thead>
                                        <tr>
                                            <th>Ref#</th>
                                            <th>Due Date</th>
                                            <th>Description</th>
                                            <th>Amount(AED)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="o.get_add_less_table(o.add_charges_ids,o.less_charges_ids)"
                                            t-as="line">
                                            <td>
                                                <span t-esc="line['jv_no']"/>
                                            </td>
                                            <td>
                                                <span t-esc="line['date'].strftime('%d/%m/%Y')"/>
                                            </td>
                                            <td>
                                                <span t-esc="line['description']"/>
                                            </td>
                                            <td>
                                                <span t-esc="'{:,.0f}'.format(line['amount'])"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>Total</strong>
                                            </td>
                                            <td></td>
                                            <td></td>
                                            <td>
                                                <strong>
                                                    <span t-esc="'{:,.0f}'.format(o.get_add_less_total(o.add_charges_ids,o.less_charges_ids))"/>
                                                </strong>
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>

                            </div>

                        </div>
                    </t>
                </t>
            </t>
        </template>

    </data>
</odoo>